# Security Policy

## Our Commitment

As a multi-agent system that executes code and interacts with sensitive repositories, security is a core pillar of GLITCHLAB. We prioritize:

* **Deterministic Governance**: Explicit orchestration over unpredictable emergent behavior.
* **Safety Boundaries**: Physical constraints on what agents can touch and execute.
* **Transparent Auditing**: Full logging of every tool call and model interaction.

## Reporting a Vulnerability

We welcome reports concerning security flaws, especially those related to:

* **Prompt Injection**: Scenarios where agent instructions can be bypassed or hijacked via task definitions or repository content.
* **Sandbox Escapes**: Methods to bypass the tool executor allowlist or the git worktree isolation.
* **Credential Leaks**: Issues that might cause GLITCHLAB to accidentally commit or log local API keys.

### How to Report

Please **do not open a public GitHub issue** for security vulnerabilities. Instead:

1. Draft a detailed report including steps to reproduce.
2. Email the report to **security@adjective.us**.
3. We will acknowledge your report within 48 hours and provide a timeline for resolution.

## Security Architecture

GLITCHLAB includes several built-in security features to protect your codebase:

### 1. Tool Allowlisting

Agents do not have arbitrary shell access. They can only execute commands explicitly defined in the tool executor's allowlist (`crates/eng-org/src/tools.rs`). Each tool has a structured schema and validated inputs.

### 2. Workspace Isolation

All agent operations happen in isolated git worktrees. No agent ever writes directly to your `main` branch.

### 3. Boundary Enforcement

You can define protected paths (e.g., your core logic or security modules) in `.glitchlab/config.yaml` that agents cannot modify without explicit override:

```yaml
boundaries:
  protected_paths:
    - "crates/kernel"
    - ".github"
```

### 4. Security Agent (Firewall Frankie)

Before any Pull Request is created, a dedicated security agent scans the entire diff for dangerous patterns, hardcoded secrets, and supply chain risks.

### 5. CISO Agent (Sentinel)

A strategic risk analysis agent evaluates blast radius, trust boundaries, and compliance implications for every change.

### 6. Type-Level Governance

`ApprovedAction<T>` in `crates/kernel/src/governance.rs` cannot be constructed outside the governance module. The Rust compiler enforces that no agent action bypasses governance checks.

## User Responsibilities

* **API Key Safety**: Never commit your API keys. Use environment variables (`GEMINI_API_KEY`, `ANTHROPIC_API_KEY`).
* **Plan Review**: Always review the execution plan generated by the Planner before approving implementation.
* **Budget Caps**: Set realistic `max_dollars_per_task` limits in `.glitchlab/config.yaml` to prevent runaway model costs.
