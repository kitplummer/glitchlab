# GLITCHLAB configuration overrides
# Values here are merged on top of built-in defaults.

boundaries:
  protected_paths:
    - ".github"
    - ".githooks"
    - "CLAUDE.md"
    - ".glitchlab/config.yaml"

limits:
  max_tool_turns: 12
  max_tokens_per_task: 80000
  max_dollars_per_task: 1.00
  max_total_tasks: 200
  max_remediation_depth: 1
  repair_budget_fraction: 0.20

routing:
  # Static fallbacks (Gemini-only)
  planner: "gemini/gemini-2.5-flash"
  implementer: "gemini/gemini-2.5-pro"
  debugger: "gemini/gemini-2.5-flash"
  security: "gemini/gemini-2.5-flash"
  release: "gemini/gemini-2.5-flash"
  archivist: "gemini/gemini-2.5-flash-lite"

  # Model pool for cost-aware chooser (Gemini-only)
  models:
    - model: "gemini/gemini-2.5-flash-lite"
      tier: economy
      capabilities: [tool_use, code]
    - model: "gemini/gemini-2.5-flash"
      tier: standard
      capabilities: [tool_use, code, long_context]
    - model: "gemini/gemini-2.5-pro"
      tier: standard_plus
      capabilities: [tool_use, code, long_context]
    # Anthropic/OpenAI disabled for Gemini-only run.
    # - model: "anthropic/claude-sonnet-4-20250514"
    #   tier: premium
    #   capabilities: [tool_use, code, long_context, vision]
    # - model: "openai/gpt-4o"
    #   tier: premium
    #   capabilities: [tool_use, code, long_context, vision]

  roles:
    planner:
      min_tier: standard
    implementer:
      min_tier: standard_plus
      requires: [tool_use, code]
    debugger:
      min_tier: standard
      requires: [tool_use]
    security:
      min_tier: economy
    release:
      min_tier: economy
    archivist:
      min_tier: economy
    architect_triage:
      min_tier: economy
      requires: [code]
    architect_review:
      min_tier: economy
      requires: [code]

  ops_diagnosis: "gemini/gemini-2.5-flash-lite"
  cost_quality_threshold: 0.7

memory:
  beads_enabled: true
  dolt_connection: "mysql://glitchlab:glitchlab@localhost:3306/glitchlab"

tqm:
  remediation_enabled: true
  remediation_priority: 2

pipeline:
  short_circuit_enabled: true
  use_claude_code_implementer: true
  claude_code_model: sonnet
  claude_code_budget_usd: 0.50

providers:
  gemini:
    api_key_env: GEMINI_API_KEY
  anthropic:
    api_key_env: ANTHROPIC_API_KEY
  openai:
    api_key_env: OPENAI_API_KEY
